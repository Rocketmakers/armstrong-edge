import { Canvas, ArgTypes } from '@storybook/blocks';
import { Meta } from '@storybook/addon-docs/blocks';
import { Select } from './select.component';

import * as SelectStories from './select.stories';

<Meta title="Components/select" component={Select} />

# Select

A select component that offers single or multiple selection, customizable sizes, and validation.

## Contents

- [Single select](#single-select)
- [Option creation for single select](#create-single)
- [Sizes](#sizes)
- [Validation](#validation)
- [Native](#native)
- [Multi select](#multi-select)
- [Option creation for multi select](#create-multi)
- [Select props](#props)

## <a name="single-select">Single select</a>

<Canvas of={SelectStories.Default} layout="centered" sourceState="none" />

```tsx
const options = [
  {
    label: 'Colours',
    options: [
      { id: 1, content: 'ocean' },
      { id: 2, content: 'blue' },
      { id: 3, content: 'purple' },
      { id: 4, content: 'red' },
      { id: 5, content: 'orange' },
      { id: 6, content: 'yellow' },
      { id: 7, content: 'green' },
      { id: 8, content: 'forest' },
      { id: 9, content: 'slate' },
      { id: 10, content: 'silver' },
    ],
  },
  {
    label: 'Flavours',
    options: [
      { id: 11, content: 'vanilla' },
      { id: 12, content: 'chocolate' },
      { id: 13, content: 'strawberry' },
    ],
  },
];

const { formProp, formState } = useForm<{ value?: number }>();

<Select bind={formProp('value').bind()} options={options} />;
<p>Current value: {formState?.value}</p>;
```

The `bind` prop is used for binding to an Armstrong form binder (see forms documentation).

The `options` prop can be an array of options or an array of grouped options with a label:

```tsx
// flat options
const options = [
  { id: 1, content: 'ocean' },
  { id: 2, content: 'blue' },
  { id: 3, content: 'purple' },
  { id: 4, content: 'red' },
];

// grouped options
const groupedOptions = [
  {
    label: 'Colours',
    options: [
      { id: 1, content: 'ocean' },
      { id: 2, content: 'blue' },
    ],
  },
  {
    label: 'Flavours',
    options: [
      { id: 11, content: 'vanilla' },
      { id: 12, content: 'chocolate' },
    ],
  },
];
```

## <a name="create-single">Option creation for single select</a>

<Canvas of={SelectStories.Create} layout="centered" sourceState="none" />

```tsx
<Select bind={formProp('value').bind()} options={options} allowCreate={true} onOptionCreated={onOptionCreated} />
```

`allowCreate` enables the user to create select options by typing into the input.

`onOptionCreated` is called when a new option is created.

## <a name="sizes">Sizes</a>

<Canvas of={SelectStories.Sizes} layout="centered" sourceState="none" />

```tsx
<Select bind={formProp('value').bind()} options={options} displaySize="small" />
```

Sizes available:

- `small`
- `medium` (default)
- `large`
- `custom-<string>`

## <a name="validation">Validation</a>

<Canvas of={SelectStories.ValidationError} layout="centered" sourceState="none" />

```tsx
<Select
  bind={formProp('value').bind()}
  options={options}
  validationMode="both"
  validationErrorMessages={['This field is required']}
  required
/>
```

`validationErrorMessages` are the validation errors from the binder concatenated with manually passed in errors.

`validationMode` determines how to render the validation errors. The `validationMode` options are `icon`, `message` or `both`.

The `required` prop displays a required indicator at the end of the label.

## <a name="native">Native</a>

<Canvas of={SelectStories.Native} layout="centered" sourceState="none" />

```tsx
<NativeSelect bind={formProp('value').bind()} options={options} />
```

## <a name="multi-select">Multi select</a>

<Canvas of={SelectStories.Multi} layout="centered" sourceState="none" />

```tsx
<MultiSelect bind={formProp('value').bind()} options={options} />
```

## <a name="create-multi">Option creation for multi select</a>

<Canvas of={SelectStories.CreateMulti} layout="centered" sourceState="none" />

```tsx
<MultiSelect bind={formProp('value').bind()} options={options} allowCreate={true} onOptionCreated={onOptionCreated} />
```

`allowCreate` enables the user to create select options by typing into the input.

`onOptionCreated` is called when a new option is created.

## <a name="props">Select props</a>

<ArgTypes of={Select} />
