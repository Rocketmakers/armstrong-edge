{"version":3,"file":"textArea.stories-73410906.js","sources":["../../src/components/textArea/textArea.component.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { IBindingProps, useBindingState } from '../../form';\nimport { useDebounce } from '../../hooks/useDebounce';\nimport { useDidUpdateEffect } from '../../hooks/useDidUpdateEffect';\nimport { ArmstrongFCExtensions, ArmstrongFCProps, ArmstrongFCReturn, DisplaySize, NullOrUndefined } from '../../types';\nimport { concat } from '../../utils/classNames';\nimport { useArmstrongConfig } from '../config';\nimport { IInputWrapperProps, InputWrapper } from '../inputWrapper/inputWrapper.component';\n\nimport './textArea.theme.css';\n\ntype NativeTextAreaProps = Omit<\n  React.DetailedHTMLProps<React.TextareaHTMLAttributes<HTMLTextAreaElement>, HTMLTextAreaElement>,\n  'value' | 'ref'\n>;\n\ninterface IDelayedTextAreaBaseProps<TValue> extends NativeTextAreaProps {\n  /** The time in ms to delay the debounce or throttle effect. */\n  milliseconds: number;\n\n  /** Called when the value changes, takes into account any delay values and other effects. */\n  onValueChange: (value: TValue | undefined) => void;\n\n  /** The current value of the input */\n  value?: TValue;\n}\n\nconst DebounceTextAreaBase = React.forwardRef<HTMLTextAreaElement, IDelayedTextAreaBaseProps<string>>(\n  ({ milliseconds, value, onValueChange, onChange, ...nativeProps }, ref) => {\n    const [actualValue, setActualValue] = useDebounce(milliseconds, value, onValueChange);\n\n    const onChangeEvent = React.useCallback(\n      (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n        setActualValue(e.currentTarget.value);\n        onChange?.(e);\n      },\n      [setActualValue, onChange]\n    );\n\n    return <textarea ref={ref} value={actualValue} onChange={onChangeEvent} {...nativeProps} />;\n  }\n);\n\nDebounceTextAreaBase.displayName = 'DebounceInput';\n\ninterface ITextAreaProps<TValue extends NullOrUndefined<string> | NullOrUndefined<number>>\n  extends NativeTextAreaProps,\n    Omit<IInputWrapperProps, 'onClick' | 'onValueChange'> {\n  /** A class name to apply to the input element */\n  textAreaClassName?: string;\n\n  /**  prop for binding to an Armstrong form binder (see forms documentation) */\n  bind?: IBindingProps<TValue>;\n\n  /** Called when the value changes, takes into account any delay values and other effects. */\n  onValueChange?: (value?: TValue) => void;\n\n  /** The delay config, used to set throttle and debounce values. */\n  delay?: number;\n\n  /** The current value of the input */\n  value?: TValue;\n\n  /** which size variant to use */\n  displaySize?: DisplaySize;\n\n  /** A callback function to handle onChange event */\n  onChange?: (e: React.ChangeEvent<HTMLTextAreaElement>) => void;\n\n  /** An ID for the label to use when testing  */\n  testId?: string;\n\n  /** should the input validate automatically against the provided schema? Default: `true` */\n  autoValidate?: boolean;\n}\n\n/** A component which wraps up a native text area element with some binding logic, labels and validation errors. */\nexport const TextArea = React.forwardRef<HTMLTextAreaElement, ITextAreaProps<string>>(\n  (\n    {\n      bind,\n      onChange,\n      value,\n      className,\n      validationErrorMessages,\n      validationMode,\n      pending,\n      disabled,\n      disableOnPending,\n      onValueChange,\n      scrollValidationErrorsIntoView,\n      delay,\n      validationErrorsClassName,\n      statusClassName,\n      textAreaClassName,\n      label,\n      required,\n      requiredIndicator,\n      displaySize,\n      labelClassName,\n      labelId,\n      testId,\n      errorIcon,\n      leftOverlay,\n      rightOverlay,\n      hideIconOnStatus,\n      statusPosition,\n      autoValidate,\n      ...nativeProps\n    },\n    ref\n  ) => {\n    const reactId = React.useId();\n    const id = nativeProps.id ?? reactId;\n\n    const [boundValue, setBoundValue, bindConfig] = useBindingState(bind, {\n      value: value?.toString(),\n      validationErrorMessages,\n      validationErrorIcon: errorIcon,\n      validationMode,\n      autoValidate,\n    });\n\n    const globals = useArmstrongConfig({\n      validationMode: bindConfig.validationMode,\n      disableControlOnPending: disableOnPending,\n      inputStatusPosition: statusPosition,\n      inputDisplaySize: displaySize,\n      requiredIndicator,\n      scrollValidationErrorsIntoView,\n      validationErrorIcon: bindConfig.validationErrorIcon,\n      hideInputErrorIconOnStatus: hideIconOnStatus,\n      autoValidate: bindConfig.autoValidate,\n    });\n\n    const onBindValueChange = React.useCallback(\n      (currentValue?: string) => {\n        const formattedValue = bind?.bindConfig?.format?.toData?.(currentValue) || currentValue;\n        setBoundValue(formattedValue);\n      },\n      [setBoundValue, bind]\n    );\n\n    const onChangeEvent = React.useCallback(\n      (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n        onChange?.(event);\n        const currentValue = event.currentTarget.value;\n        onBindValueChange(currentValue);\n        onValueChange?.(currentValue);\n      },\n      [onBindValueChange, onChange, onValueChange]\n    );\n\n    /** onChange used for throttled inputs */\n    const onValueChangeEvent = React.useCallback(\n      (currentValue?: string) => {\n        onBindValueChange(currentValue);\n        onValueChange?.(currentValue);\n      },\n      [onValueChange, onBindValueChange]\n    );\n\n    useDidUpdateEffect(() => {\n      if (globals.autoValidate && bindConfig.isTouched) {\n        bindConfig.validate();\n      }\n    }, [boundValue]);\n\n    const onBlurEvent = React.useCallback(\n      (event: React.FocusEvent<HTMLTextAreaElement, HTMLElement>) => {\n        if (globals.autoValidate && !bindConfig.isTouched) {\n          bindConfig.validate();\n        }\n        bindConfig.setTouched(true);\n        return nativeProps.onBlur?.(event);\n      },\n      [bindConfig, globals.autoValidate, nativeProps]\n    );\n\n    const textAreaProps: NativeTextAreaProps & { value?: string } = {\n      id,\n      className: concat('arm-text-area', textAreaClassName),\n      /** fallback to an empty string if bind is passed in but bound value is undefined to avoid React warning */\n      value: boundValue?.toString() ?? (bind && ''),\n      disabled,\n      onBlur: onBlurEvent,\n    };\n\n    return (\n      <InputWrapper\n        data-size={globals.inputDisplaySize}\n        className={concat(className, 'arm-text-area-wrapper')}\n        statusClassName={concat(statusClassName, 'arm-text-area-status')}\n        validationErrorsClassName={concat(validationErrorsClassName, 'arm-text-area-validation')}\n        validationErrorMessages={bindConfig.validationErrorMessages}\n        errorIcon={bindConfig.validationErrorIcon}\n        validationMode={bindConfig.validationMode}\n        pending={pending}\n        disabled={disabled}\n        statusPosition={globals.inputStatusPosition}\n        scrollValidationErrorsIntoView={globals.scrollValidationErrorsIntoView}\n        disableOnPending={globals.disableControlOnPending}\n        hideIconOnStatus={globals.hideInputErrorIconOnStatus}\n        label={label}\n        labelId={labelId ?? id}\n        labelClassName={concat(labelClassName, 'arm-text-area-label')}\n        required={required}\n        requiredIndicator={globals.requiredIndicator}\n        data-testid={testId}\n        leftOverlay={leftOverlay}\n        rightOverlay={rightOverlay}\n      >\n        {!!delay && (\n          <DebounceTextAreaBase\n            {...nativeProps}\n            {...textAreaProps}\n            milliseconds={delay}\n            onChange={onChange}\n            onValueChange={onValueChangeEvent}\n            ref={ref}\n          />\n        )}\n        {!delay && (\n          <textarea\n            className={'arm-text-area'}\n            {...nativeProps}\n            {...textAreaProps}\n            onChange={onChangeEvent}\n            ref={ref}\n            disabled={disabled || pending}\n          />\n        )}\n      </InputWrapper>\n    );\n  }\n  // type assertion to ensure generic works with RefForwarded component\n  // DO NOT CHANGE TYPE WITHOUT CHANGING THIS, FIND TYPE BY INSPECTING React.forwardRef\n) as (<TStringValue extends NullOrUndefined<string>>(\n  props: ArmstrongFCProps<ITextAreaProps<TStringValue>, HTMLTextAreaElement>\n) => ArmstrongFCReturn) &\n  ArmstrongFCExtensions<ITextAreaProps<string>>;\n\nTextArea.displayName = 'Text Area';\n"],"names":["DebounceTextAreaBase","React.forwardRef","milliseconds","value","onValueChange","onChange","nativeProps","ref","actualValue","setActualValue","useDebounce","onChangeEvent","React.useCallback","e","jsx","TextArea","bind","className","validationErrorMessages","validationMode","pending","disabled","disableOnPending","scrollValidationErrorsIntoView","delay","validationErrorsClassName","statusClassName","textAreaClassName","label","required","requiredIndicator","displaySize","labelClassName","labelId","testId","errorIcon","leftOverlay","rightOverlay","hideIconOnStatus","statusPosition","autoValidate","reactId","React.useId","id","boundValue","setBoundValue","bindConfig","useBindingState","globals","useArmstrongConfig","onBindValueChange","currentValue","formattedValue","_c","_b","_a","event","onValueChangeEvent","useDidUpdateEffect","onBlurEvent","textAreaProps","concat","jsxs","InputWrapper"],"mappings":"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"}