import{r as s}from"./index-Cqyox1Tj.js";import{b as K,c as oe}from"./useDidUpdateEffect-CbsfOrtL.js";import{j as Q}from"./jsx-runtime-Cl2eCCBe.js";import{_ as z}from"./extends-CF3RwP-h.js";import"./index-QqxU7g3h.js";import{c as ae}from"./classNames-TtGgGdEV.js";import{u as se}from"./config.context-DSGy4VcJ.js";function Ie(e,t){return e.reduce((r,a,l)=>t(a)?l:r,-1)}function Fe(e,t){const r=[];for(let a=0;a<e;a+=1)r.push(a);return r.map(t)}function le(e){const t=[];for(const r of e)t.includes(r)||t.push(r);return t}function ue(e,t){return s.useMemo(()=>{var r;return le([...t??[],...((r=e==null?void 0:e.myValidationErrors)==null?void 0:r.map(a=>a.message))??[]])},[t,e==null?void 0:e.myValidationErrors])}function De(e,t){var S,V,M,R,y;const r=s.useMemo(()=>{var p,c,m;return(t==null?void 0:t.value)??((m=(c=(p=e==null?void 0:e.bindConfig)==null?void 0:p.format)==null?void 0:c.fromData)==null?void 0:m.call(c,e.value))??(e==null?void 0:e.value)},[t==null?void 0:t.value,(S=e==null?void 0:e.bindConfig)==null?void 0:S.format,e==null?void 0:e.value]),a=s.useCallback(p=>{var c,m,E,A,v;p!==void 0&&((c=t==null?void 0:t.onChange)==null||c.call(t,p)),(v=e==null?void 0:e.setValue)==null||v.call(e,((A=(E=(m=e.bindConfig)==null?void 0:m.format)==null?void 0:E.toData)==null?void 0:A.call(E,p))??p)},[e,t]),l=s.useCallback(p=>{var c,m,E;return((E=(m=(c=e==null?void 0:e.bindConfig)==null?void 0:c.format)==null?void 0:m.fromData)==null?void 0:E.call(m,p))??p},[(V=e==null?void 0:e.bindConfig)==null?void 0:V.format]),f=s.useCallback(p=>{var c,m,E;return((E=(m=(c=e==null?void 0:e.bindConfig)==null?void 0:c.format)==null?void 0:m.toData)==null?void 0:E.call(m,p))??p},[(M=e==null?void 0:e.bindConfig)==null?void 0:M.format]),u=ue(e,t==null?void 0:t.validationErrorMessages),i=(t==null?void 0:t.validationMode)??((R=e==null?void 0:e.formConfig)==null?void 0:R.validationMode)??"both",w=(t==null?void 0:t.validationErrorIcon)??((y=e==null?void 0:e.formConfig)==null?void 0:y.validationErrorIcon);return[r,a,{getFormattedValueFromData:l,getFormattedValueToData:f,validationErrorMessages:u,isTouched:(e==null?void 0:e.isTouched)??!1,setTouched:p=>e==null?void 0:e.setTouched(p),validate:(p,c)=>{var m;return(e==null?void 0:e.validate(p,c,(m=e==null?void 0:e.bindConfig)==null?void 0:m.autoValidateAll))??!0},isValid:((e==null?void 0:e.isValid)??!0)&&!u.length,validationMode:i,validationErrorIcon:w,shouldShowValidationErrorIcon:i==="icon"||i==="both",shouldShowValidationErrorMessage:i==="message"||i==="both"}]}function _(e,t){return t!=null&&t.length?t.reduce((r,a)=>r==null?void 0:r[a],e??{}):e}function ne(e,t,r){if(t.length===0){if(Array.isArray(r))return[...r];if(typeof r=="object")return{...r}}const a=Array.isArray(e)||Number.isInteger(t[0])?[...e||[]]:{...e||{}};let l=a;for(let f=0;f<t.length;f+=1){const u=t[f];f===t.length-1?Array.isArray(r)?l[u]=[...r]:typeof r=="object"?l[u]={...r}:l[u]=r:Array.isArray(l[u])?(l[u]=[...l[u]],l=l[u]):typeof l[u]=="object"?(l[u]={...l[u]},l=l[u]):Number.isInteger(u)?(l[u]=[...l[u]],l=l[u]):(l[u]={...l[u]},l=l[u])}return a}function j(e,t){if(e&&!Array.isArray(e))throw new Error(`"${t}" cannot be used on a set form property that does not contain an array value, the current value of this property is: ${JSON.stringify(e)}`);return!0}function x(e,t){switch(t){case"dots":return(e==null?void 0:e.filter(r=>!!r).join("."))??"";case"brackets":return(e==null?void 0:e.reduce((r,a)=>typeof a=="string"?`${r}${r?".":""}${a}`:typeof a=="number"?`${r}[${a}]`:r,""))??"";default:throw new Error(`Unsupported mode: ${t} sent to validation key factory`)}}function G(e,...t){return e?t.some(r=>r===e||e.indexOf(`${r}.`)===0||e.indexOf(`${r}[`)===0):!0}const L=(e,t)=>e.filter(r=>G(r,x(t,"dots"))),ce=(e,t)=>{switch(t.type){case"set-touched":if(t.touched){const r=x(t.keyChain,"dots");return e.includes(r)?e:[...e.filter(a=>a!==r),r]}{const r=L(e,t.keyChain);return e.some(a=>r.includes(a))?e.filter(a=>!r.includes(a)):e}case"reset-touched":return[];default:return e}};function W(e=[],t=[]){if(!t.length)return[];const r=x(t,"dots"),a=x(t,"brackets");return e.filter(l=>G(l.key,r,a))}function fe(e,t){switch(t.type){case"add-validation":return[...e,...t.errors];case"clear-validation":return e.filter(r=>{var a,l;return!((!t.key||t.key===r.key)&&(!((a=t.identifiers)!=null&&a.length)||(l=t.identifiers)!=null&&l.some(f=>f===r.identifier)))});default:return e}}const me=(e,t)=>e.filter(r=>t?G(x(r.path,"dots"),t):!0).map(r=>({key:x(r.path,"dots"),message:r.message})),ie=(e,t,r,a,l,f,u,i,w,S,V,M,R)=>{var J;const y=K(V),p=K(S),[c,m]=s.useState(!1),E=s.useCallback((o,n)=>{o.length===1?r({type:"set-one",propertyKey:o[0],value:n}):r({type:"set-path",keyChain:o,value:n})},[r]);s.useEffect(()=>{m(!1)},[M]);const A=s.useCallback((...o)=>{l({type:"add-validation",errors:o})},[l]),v=s.useCallback((o,n,$)=>{const g=Array.isArray(n)?n:[n],h=x(o,"dots");A(...g.map(d=>({key:h,message:d,identifier:$})))},[A]),P=s.useCallback((...o)=>{l({type:"clear-validation",identifiers:o.length?o:void 0})},[l]),T=s.useCallback((o,n)=>{const $=x(o,"dots"),g=x(o,"brackets");l({type:"clear-validation",key:$,identifiers:n}),l({type:"clear-validation",key:g,identifiers:n})},[l]),I=s.useCallback((o,n,$)=>{if(j(n,"formProp.add")){const g=[...n??[]];g.push($),r({type:"set-path",keyChain:o,value:g})}},[r]),B=s.useCallback((o,n,$)=>{if(j(n,"formProp.remove")){const g=[...n??[]];g.splice($,1),r({type:"set-path",keyChain:o,value:g})}},[r]),H=s.useCallback((o,n,$,g)=>{if(j(n,"formProp.insert")){const h=[...n??[]];h.splice($,0,g),r({type:"set-path",keyChain:o,value:h})}},[r]),O=s.useCallback((o,n)=>{if(j(n,"formProp.pop")){const $=[...n??[]];$.pop(),r({type:"set-path",keyChain:o,value:$})}},[r]),D=s.useCallback((o,n)=>{i({type:"set-touched",keyChain:o,touched:n})},[i]),q=s.useMemo(()=>[...a,...(y==null?void 0:y.validationErrors)??[]],[a,y==null?void 0:y.validationErrors]),U=s.useCallback((o,n)=>{const $=L(f,o),g=W(q,o);return{value:_(e,o),setValue:h=>E(o,h),bindConfig:n,formConfig:y,myValidationErrors:g,dispatch:r,keyChain:o,fullKeyChain:o,initialValue:_(p,o),addValidationError:(h,d)=>v(o,h,d),clearClientValidationErrors:(...h)=>T(o,h),setTouched:h=>D(o,h),isTouched:!!$.length||c||!!M,myTouchedState:$,clientValidationDispatcher:l,touchedStateDispatcher:i,allTouched:c,validate:(h=!0,d=!1,F=!1)=>(h&&D(o,!0),w(F?void 0:o,d)),isValid:!g.length,parseValidationSchema:w}},[f,q,e,y,r,R,p,c,M,l,i,w,E,v,T,D]),k=s.useCallback((o=!0,n=!1)=>(o&&m(!0),w([],n)),[w,m]),N=s.useCallback((...o)=>{const n=_(t.current,o),$=L(u.current,o),g=W(q,o);return{bind:d=>U(o,d),set:d=>(E(o,d),N(...o)),clear:()=>(E(o,void 0),N(...o)),get:()=>n,add:d=>(I(o,n,d),N(...o)),pop:()=>(O(o,n),N(...o)),insert:(d,F)=>(H(o,n,F,d),N(...o)),remove:d=>(B(o,n,d),N(...o)),addValidationError:(d,F)=>(v(o,d,F),N(...o)),clearClientValidationErrors:(...d)=>(T(o,d),N(...o)),validate:(d=!0,F=!1)=>(d&&D(o,!0),w(o,F)),isTouched:!!$.length||c||!!M,setTouched:d=>(D(o,d),N(...o)),isValid:!g.length}},[t,u,c,M,q,U,E,I,O,H,B,v,T,w,D]),b=s.useCallback(()=>t.current,[t]),ee=s.useCallback(()=>{r({type:"set-all",data:p})},[p,r]),te=s.useCallback(o=>r({type:"set-all",data:o}),[r]),re=s.useCallback(()=>{m(!1),i({type:"reset-touched"})},[i]);return{formState:e,formProp:N,resetFormData:ee,getFormData:b,setFormData:te,clearClientValidationErrors:P,addValidationError:A,validate:k,touchAll:()=>m(!0),allTouched:c,isValid:!a.length&&!((J=y==null?void 0:y.validationErrors)!=null&&J.length),resetTouchedState:re}};function X(e){return typeof e=="function"}function pe(e,t){switch(t.type){case"set-one":return Array.isArray(e)||Number.isInteger(t.propertyKey)?(e||[]).map((r,a)=>a===t.propertyKey?t.value:e[a]):{...e||{},[t.propertyKey]:t.value};case"set-path":return ne(e,t.keyChain,t.value);case"set-all":return Array.isArray(t.data)?[...t.data]:{...t.data};default:return e}}function Pe(e,t){const r=K(e),[a,l]=s.useState(X(r)?r():r??{}),[f,u]=s.useReducer(fe,[]),[i,w]=s.useState([]),S=s.useRef(a),V=s.useRef(i),M=s.useMemo(()=>X(r)?r(S.current):r??{},[r]),R=K(M),y=s.useCallback(A=>(S.current=pe(S.current,A),l(S.current),S.current),[l]),p=s.useCallback(A=>(V.current=ce(V.current,A),w(V.current),V.current),[w]);oe(()=>{y({type:"set-all",data:R})},[R]);const c=s.useMemo(()=>{},[t==null?void 0:t.validationSchema,a]),m=s.useCallback((A=[],v)=>{if(!c)throw new Error("No validation schema has been provided");const P=A.length?x(A,"dots"):void 0;v||u({type:"clear-validation",key:P});const T=c.safeParse(S.current??{});let I=[];return T.success||(I=me(T.error.errors,P),I.length&&!v&&u({type:"add-validation",errors:I})),!I.length},[c,u,S,t==null?void 0:t.logSchemaErrors]);return ie(a,S,y,f,u,i,V,p,(A,v)=>c?m(A,v):!0,R,t)}function de(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function ye(...e){return t=>e.forEach(r=>de(r,t))}const Y=s.forwardRef((e,t)=>{const{children:r,...a}=e,l=s.Children.toArray(r),f=l.find($e);if(f){const u=f.props.children,i=l.map(w=>w===f?s.Children.count(u)>1?s.Children.only(null):s.isValidElement(u)?u.props.children:null:w);return s.createElement(Z,z({},a,{ref:t}),s.isValidElement(u)?s.cloneElement(u,void 0,i):null)}return s.createElement(Z,z({},a,{ref:t}),r)});Y.displayName="Slot";const Z=s.forwardRef((e,t)=>{const{children:r,...a}=e;return s.isValidElement(r)?s.cloneElement(r,{...ge(a,r.props),ref:t?ye(t,r.ref):r.ref}):s.Children.count(r)>1?s.Children.only(null):null});Z.displayName="SlotClone";const Ee=({children:e})=>s.createElement(s.Fragment,null,e);function $e(e){return s.isValidElement(e)&&e.type===Ee}function ge(e,t){const r={...t};for(const a in t){const l=e[a],f=t[a];/^on[A-Z]/.test(a)?l&&f?r[a]=(...i)=>{f(...i),l(...i)}:l&&(r[a]=l):a==="style"?r[a]={...l,...f}:a==="className"&&(r[a]=[l,f].filter(Boolean).join(" "))}return{...e,...r}}const we=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ae=we.reduce((e,t)=>{const r=s.forwardRef((a,l)=>{const{asChild:f,...u}=a,i=f?Y:t;return s.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),s.createElement(i,z({},u,{ref:l}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),he=s.forwardRef((e,t)=>s.createElement(Ae.label,z({},e,{ref:t,onMouseDown:r=>{var a;(a=e.onMouseDown)===null||a===void 0||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault()}}))),Se=he,C=s.forwardRef(({required:e,className:t,requiredIndicator:r,children:a,displaySize:l,...f},u)=>{const i=se({inputDisplaySize:l,requiredIndicator:r});return Q.jsxs(Se,{className:ae("arm-label",t),ref:u,"data-size":i.inputDisplaySize,...f,children:[a,e&&Q.jsxs("span",{className:"arm-label-required-indicator",children:[" ",i.requiredIndicator]})]})});C.displayName="Label";C.__docgenInfo={description:"Render a status icon which can either be pending or errored",methods:[],displayName:"Label",props:{required:{required:!1,tsType:{name:"boolean"},description:"Should the label show a required indicator?"},requiredIndicator:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:'Symbol to use as the required indicator, defaults to "*"'},displaySize:{required:!1,tsType:{name:"union",raw:"'small' | 'medium' | 'large' | CustomString",elements:[{name:"literal",value:"'small'"},{name:"literal",value:"'medium'"},{name:"literal",value:"'large'"},{name:"literal",value:"`custom-${string}`"}]},description:"which size variant to use"}},composes:["Omit"]};export{C as L,De as a,Ie as f,Fe as r,Pe as u};
