{"version":3,"file":"input.component-37b2e74c.js","sources":["../../src/components/input/input.component.tsx"],"sourcesContent":["import * as React from 'react';\nimport { HTMLInputTypeAttribute } from 'react';\n\nimport { IBindingProps, useBindingState } from '../../form';\nimport { useDebounce } from '../../hooks/useDebounce';\nimport { useDidUpdateEffect } from '../../hooks/useDidUpdateEffect';\nimport { ArmstrongFCExtensions, ArmstrongFCProps, ArmstrongFCReturn, DisplaySize, NullOrUndefined } from '../../types';\nimport { concat } from '../../utils/classNames';\nimport { useArmstrongConfig } from '../config';\nimport { IInputWrapperProps, InputWrapper } from '../inputWrapper/inputWrapper.component';\n\nimport './input.theme.css';\n\ntype NativeInputProps = Omit<\n  React.DetailedHTMLProps<React.InputHTMLAttributes<HTMLInputElement>, HTMLInputElement>,\n  'value' | 'ref'\n>;\n\ninterface IDelayedInputBaseProps<TValue> extends NativeInputProps {\n  /** The time in ms to delay the debounce or throttle effect. */\n  milliseconds: number;\n\n  /** Called when the value changes, takes into account any delay values and other effects. */\n  onValueChange: (value: TValue | undefined) => void;\n\n  /** The current value of the input */\n  value?: TValue;\n}\n\nconst DebounceInputBase = React.forwardRef<HTMLInputElement, IDelayedInputBaseProps<string>>(\n  ({ milliseconds, value, onValueChange, onChange, ...nativeProps }, ref) => {\n    const [actualValue, setActualValue] = useDebounce(milliseconds, value, onValueChange);\n\n    const onChangeEvent = React.useCallback(\n      (e: React.ChangeEvent<HTMLInputElement>) => {\n        setActualValue(e.currentTarget.value);\n        onChange?.(e);\n      },\n      [setActualValue, onChange]\n    );\n\n    return <input ref={ref} value={actualValue} onChange={onChangeEvent} {...nativeProps} />;\n  }\n);\n\nDebounceInputBase.displayName = 'DebounceInput';\n\ninterface IInputProps<TValue extends NullOrUndefined<string> | NullOrUndefined<number>>\n  extends Omit<NativeInputProps, 'type'>,\n    IInputWrapperProps {\n  /** A class name to apply to the input element */\n  inputClassName?: string;\n\n  /**  prop for binding to an Armstrong form binder (see forms documentation) */\n  bind?: IBindingProps<TValue>;\n\n  /** Called when the value changes, takes into account any delay values and other effects. */\n  onValueChange?: (value?: TValue) => void;\n\n  /** The delay config, used to set throttle and debounce values. */\n  delay?: number;\n\n  /** The current value of the input */\n  value?: TValue;\n\n  /** which size variant to use */\n  displaySize?: DisplaySize;\n\n  /** optional test ID to use for the input wrapper */\n  wrapperTestId?: string;\n\n  /** should the input validate automatically against the provided schema? Default: `true` */\n  autoValidate?: boolean;\n}\n\ntype SupportedStringInputTypes =\n  | 'color'\n  | 'date'\n  | 'datetime-local'\n  | 'email'\n  | 'month'\n  | 'password'\n  | 'search'\n  | 'tel'\n  | 'text'\n  | 'time'\n  | 'url'\n  | 'week'\n  | 'hidden';\n\nexport interface ITextInputProps<TValue extends NullOrUndefined<string>> extends IInputProps<TValue> {\n  /** The type of input, used to discriminate the bind/value type */\n  type?: Extract<HTMLInputTypeAttribute, SupportedStringInputTypes>;\n}\n\nexport interface INumberInputProps<TValue extends NullOrUndefined<number>> extends IInputProps<TValue> {\n  /** The type of input, used to discriminate the bind/value type */\n  type: 'number';\n}\n\n/** A component which wraps up a native input element with some binding logic and some repeated elements (icons and stuff) for components which only contain a single input element. */\nexport const Input = React.forwardRef<\n  HTMLInputElement,\n  IInputProps<string | number> & { type?: HTMLInputTypeAttribute }\n>(\n  (\n    {\n      bind,\n      onChange,\n      value,\n      className,\n      leftOverlay,\n      rightOverlay,\n      validationErrorMessages,\n      validationMode,\n      errorIcon: validationErrorIcon,\n      pending,\n      disabled,\n      disableOnPending,\n      statusPosition,\n      hideIconOnStatus,\n      onValueChange,\n      scrollValidationErrorsIntoView,\n      delay,\n      validationErrorsClassName,\n      statusClassName,\n      inputClassName,\n      label,\n      required,\n      requiredIndicator,\n      displaySize,\n      labelClassName,\n      labelId,\n      wrapperTestId,\n      error,\n      autoValidate,\n      ...nativeProps\n    },\n    ref\n  ) => {\n    const reactId = React.useId();\n    const id = nativeProps.id ?? reactId;\n\n    const [boundValue, setBoundValue, bindConfig] = useBindingState(bind, {\n      value: value?.toString(),\n      validationErrorMessages,\n      validationMode,\n      validationErrorIcon,\n      autoValidate,\n    });\n\n    const globals = useArmstrongConfig({\n      validationMode: bindConfig.validationMode,\n      disableControlOnPending: disableOnPending,\n      hideInputErrorIconOnStatus: hideIconOnStatus,\n      inputDisplaySize: displaySize,\n      inputStatusPosition: statusPosition,\n      requiredIndicator,\n      validationErrorIcon: bindConfig.validationErrorIcon,\n      scrollValidationErrorsIntoView,\n      autoValidate: bindConfig.autoValidate,\n    });\n\n    const parseValue = React.useCallback(\n      (unparsedValue?: string) => {\n        if (nativeProps.type !== 'number') {\n          return unparsedValue;\n        }\n        if (unparsedValue !== null && unparsedValue !== undefined && unparsedValue !== '') {\n          return parseFloat(unparsedValue);\n        }\n        return undefined;\n      },\n      [nativeProps.type]\n    );\n\n    const onBindValueChange = React.useCallback(\n      (currentValue?: string) => {\n        const parsedValue = parseValue(currentValue);\n        const formattedValue = bind?.bindConfig?.format?.toData?.(parsedValue) || parsedValue;\n        setBoundValue(formattedValue);\n      },\n      [setBoundValue, bind, parseValue]\n    );\n\n    const onChangeEvent = React.useCallback(\n      (event: React.ChangeEvent<HTMLInputElement>) => {\n        onChange?.(event);\n        const currentValue = event.currentTarget.value;\n        onBindValueChange(currentValue);\n        onValueChange?.(parseValue(currentValue));\n      },\n      [onBindValueChange, onChange, onValueChange, parseValue]\n    );\n\n    /** onChange used for throttled inputs */\n    const onValueChangeEvent = React.useCallback(\n      (currentValue?: string) => {\n        onBindValueChange(currentValue);\n        onValueChange?.(parseValue(currentValue));\n      },\n      [onValueChange, onBindValueChange, parseValue]\n    );\n\n    useDidUpdateEffect(() => {\n      if (globals.autoValidate && bindConfig.isTouched) {\n        bindConfig.validate();\n      }\n    }, [boundValue]);\n\n    const onBlurEvent = React.useCallback(\n      (event: React.FocusEvent<HTMLInputElement, HTMLElement>) => {\n        if (globals.autoValidate && !bindConfig.isTouched) {\n          bindConfig.validate();\n        }\n        bindConfig.setTouched(true);\n        return nativeProps.onBlur?.(event);\n      },\n      [bindConfig, globals.autoValidate, nativeProps]\n    );\n\n    const inputProps: NativeInputProps & { value?: string; 'data-testid'?: string } = {\n      id,\n      className: concat('arm-input-base-input', inputClassName),\n      /** fallback to an empty string if bind is passed in but bound value is undefined to avoid React warning */\n      value: boundValue?.toString() ?? (bind && ''),\n      disabled,\n      ...nativeProps,\n      onBlur: onBlurEvent,\n    };\n\n    return (\n      <InputWrapper\n        data-size={globals.inputDisplaySize}\n        className={concat(className, 'arm-input-base')}\n        statusClassName={concat(statusClassName, 'arm-input-base-status')}\n        validationErrorsClassName={concat(validationErrorsClassName, 'arm-input-base-validation')}\n        leftOverlay={leftOverlay}\n        rightOverlay={rightOverlay}\n        validationErrorMessages={bindConfig.validationErrorMessages}\n        errorIcon={bindConfig.validationErrorIcon}\n        validationMode={bindConfig.validationMode}\n        pending={pending}\n        disabled={disabled}\n        statusPosition={globals.inputStatusPosition}\n        scrollValidationErrorsIntoView={globals.scrollValidationErrorsIntoView}\n        disableOnPending={globals.disableControlOnPending}\n        hideIconOnStatus={globals.hideInputErrorIconOnStatus}\n        label={label}\n        labelId={labelId ?? id}\n        labelClassName={concat(labelClassName, 'arm-input-base-label')}\n        required={required}\n        error={error}\n        requiredIndicator={globals.requiredIndicator}\n        data-testid={wrapperTestId}\n        displaySize={globals.inputDisplaySize}\n      >\n        {!!delay && (\n          <DebounceInputBase\n            {...nativeProps}\n            {...inputProps}\n            milliseconds={delay}\n            onChange={onChange}\n            onValueChange={onValueChangeEvent}\n            ref={ref}\n            data-size={displaySize}\n          />\n        )}\n        {!delay && (\n          <input {...nativeProps} {...inputProps} onChange={onChangeEvent} ref={ref} data-size={displaySize} />\n        )}\n      </InputWrapper>\n    );\n  }\n  // type assertion to ensure generic works with RefForwarded component\n  // DO NOT CHANGE TYPE WITHOUT CHANGING THIS, FIND TYPE BY INSPECTING React.forwardRef\n) as (<TStringValue extends NullOrUndefined<string>, TNumberValue extends NullOrUndefined<number>>(\n  props: ArmstrongFCProps<ITextInputProps<TStringValue> | INumberInputProps<TNumberValue>, HTMLInputElement>\n) => ArmstrongFCReturn) &\n  ArmstrongFCExtensions<ITextInputProps<string> | INumberInputProps<number>>;\n\nInput.displayName = 'Input';\n"],"names":["DebounceInputBase","React.forwardRef","milliseconds","value","onValueChange","onChange","nativeProps","ref","actualValue","setActualValue","useDebounce","onChangeEvent","React.useCallback","e","jsx","Input","bind","className","leftOverlay","rightOverlay","validationErrorMessages","validationMode","validationErrorIcon","pending","disabled","disableOnPending","statusPosition","hideIconOnStatus","scrollValidationErrorsIntoView","delay","validationErrorsClassName","statusClassName","inputClassName","label","required","requiredIndicator","displaySize","labelClassName","labelId","wrapperTestId","error","autoValidate","reactId","React.useId","id","boundValue","setBoundValue","bindConfig","useBindingState","globals","useArmstrongConfig","parseValue","unparsedValue","onBindValueChange","currentValue","parsedValue","formattedValue","_c","_b","_a","event","onValueChangeEvent","useDidUpdateEffect","onBlurEvent","inputProps","concat","jsxs","InputWrapper"],"mappings":"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"}